---
title: "Wpływ Social Media na życia studentów"
author: "Medard Pikul, Hanna Móżdżyńska, Zośka Stasiak, Marta Rutkowska" 
date: "`r Sys.Date()`"
output:
  rmdformats::readthedown:
    highlight: kate
    self_contained: true
    number_sections: true
    code_folding: show
    fig_width: 8
    fig_height: 5
    fig_caption: true
---

```{r setup, include=FALSE}
## Global options
knitr::opts_chunk$set(cache = TRUE)
dane <- read.csv("Students Social Media Addiction.csv")
library(tidyverse)
library(naniar)
library(validate)
library(validatetools)
library(dcmodify)
library(errorlocate)
library(ggplot2)
```

# Wprowadzenie

Celem niniejszego raportu jest analiza wpływu social media na życia studentów. Raport zawiera przegląd kluczowych danych, ich wizualizacje oraz obszerne wnioski. Zbiór danych zawiera `r nrow(dane)` wierszy oraz `r ncol(dane)`kolumn.

## Opis danych

Dane zawierają następujące kolumny:

# Porządkowanie danych

## Braki danych

```{r include=FALSE}
procent <- prop_complete_var(dane)*100
```

W danych znajduje się `r procent` % kompletnych wartości.

```{r include=FALSE}
naniar::vis_miss(dane)
```

## Walidacja danych

- czy wiek przyjmuje wartości od 16 - 25?
- czy godziny przyjmują wartości 0 - 24?
- czy wszystkie wartości liczbowe są większe od 0? 
- czy mental health score i addicted score  przyjmują wartości 1 - 10? 
- płeć - kobieta lub mężczyzna?
- academic level - high school, undergraduate, graduate? 
- relationship status - single, in relationship, complicated?
- affects academic performance - yes/no?


```{r}
reguly <- validator(
Age >= 16 & Age <= 25,
Gender %in% c("Female", "Male"),
Academic_Level  %in% c("High School", "Undergraduate", "Graduate"),
Avg_Daily_Usage_Hours > 0 & Avg_Daily_Usage_Hours < 24,
Affects_Academic_Performance %in% c("Yes", "No"),
Sleep_Hours_Per_Night >= 0 & Sleep_Hours_Per_Night <= 24,
Mental_Health_Score >= 1 & Mental_Health_Score<=10,
Relationship_Status %in% c("In Relationship", "Single", "Complicated"),
Addicted_Score >= 1 & Addicted_Score <= 10
)
```

```{r}
cf <- confront(dane, reguly, key="Student_ID")

barplot(cf)

```

# Wizualizacja danych

## Charakterystyka demograficzna badanej grupy studenckiej 

### Rozkład Płci i Poziomu Akademickiego

```{r}
dane$Academic_Level <- factor(dane$Academic_Level, 
                            levels = c("High School", "Undergraduate", "Graduate"))
dane$Gender <- factor(dane$Gender,
                  levels = c("Male", "Female")
)

ggplot(dane, aes(x = Academic_Level, fill=Gender)) +
  geom_bar(position = "dodge") +
  labs(title = "Rozkład płci i poziomu akademickiego",
       x = "Poziom akademicki",
       y = "Liczba studentów") +
  theme_minimal()
```
### Wiek badanych
```{r}
ggplot(dane, aes(x = Age)) +
  geom_histogram(binwidth = 0.5, fill = "skyblue", color = "black") +
  labs(title = "Wiek badanych studentów",
       x = "Wiek",
       y = "Liczba studentów") +
  theme_minimal()
```
## Intensywność Używania Social Mediów 

### Średni czas użycia

```{r}
ggplot(dane, aes(x = Avg_Daily_Usage_Hours)) +
  geom_histogram(binwidth = 1, fill = "#9f2042", color = "#6c0d27") +
  labs(title = "Średni czas użycia social mediów dziennie",
       x = "Średni czas użycia (h)",
       y = "Liczba studentów") +
  theme_minimal()
``` 
### Najczęściej używane platformy 

```{r}
dane %>%
mutate(top_5 = fct_lump_n(Most_Used_Platform, n = 4, other_level = "Inne")) %>%
  ggplot(aes(x = top_5)) +
  geom_bar(fill = "#6c0d27") +
  labs(title = "Najczęściej używane platformy social media",
       x = "Platforma",
       y = "Liczba studentów") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```