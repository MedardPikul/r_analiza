---
title: "Wpływ Social Media na życia studentów"
author: "Medard Pikul, Hanna Móżdżyńska, Zosia Stasiak, Marta Rutkowska" 
date: "`r Sys.Date()`"
output:
  rmdformats::readthedown:
    highlight: kate
    self_contained: true
    number_sections: true
    code_folding: show
    fig_width: 8
    fig_height: 5
    fig_caption: true
---

```{r setup, include=FALSE}
## Global options
knitr::opts_chunk$set(cache = TRUE)
dane <- read.csv("Students Social Media Addiction.csv")
library(tidyverse)
library(naniar)
library(validate)
library(validatetools)
library(dcmodify)
library(errorlocate)
library(ggplot2)
library(plotly)
library(gtsummary)
library(summarytools)
library(knitr)
library(kableExtra)
library(psych)
library(broom)
library(ggstatsplot)
library(corrplot)
```

# Wprowadzenie

W dobie powszechnej cyfryzacji media społecznościowe stały się nieodłącznym elementem codzienności akademickiej, kształtując sposób, w jaki studenci komunikują się, spędzają wolny czas i budują relacje. Celem niniejszego raportu jest wielowymiarowa analiza wpływu korzystania z platform społecznościowych na dobrostan studentów. Szczególny nacisk położono na zbadanie korelacji między czasem ekranowym a zdrowiem psychicznym, jakością snu oraz wynikami w nauce.

Raport zawiera przegląd kluczowych statystyk, wizualizację rozkładu zmiennych oraz wnioski płynące z analizy zależności między cechami demograficznymi a wzorcami zachowań cyfrowych. Analizowany zbiór danych składa się z `r nrow(dane)` obserwacji oraz `r ncol(dane)` zmiennych, obejmujących m.in. dane demograficzne, preferowane platformy, czas użytkowania oraz wskaźniki subiektywnego poczucia uzależnienia.

Projekt pomoże odpowiedzieć na postawione przez nas pytania badawcze, takie jak: - Czy istnieje statystycznie istotna zależność między poziomem uzależnienia od social mediów a zdrowiem psychicznym studentów, - Jak korzystanie z mediów społecznościowych wpływa na wyniki akademickie? -

## Opis danych

Analizowany zbiór danych składa się z 13 zmiennych dotyczących studentów z różnych krajów. Dane obejmują trzy kluczowe obszary:

```         
Demografię (m.in. wiek, płeć, poziom edukacji).

Aktywność w sieci (średni czas korzystania, najczęściej używana platforma).

Wskaźniki dobrostanu (poziom uzależnienia, ocena zdrowia psychicznego, jakość snu oraz wpływ na wyniki w nauce).
```

Zbiór jest kompletny i nie zawiera brakujących wartości.

# Porządkowanie danych

## Braki danych

```{r include=FALSE}
procent <- prop_complete_var(dane)*100
```

W danych znajduje się `r procent` % kompletnych wartości.

```{r include=FALSE}
naniar::vis_miss(dane)
```

## Walidacja danych

-   czy wiek przyjmuje wartości od 16 - 25?
-   czy godziny przyjmują wartości 0 - 24?
-   czy wszystkie wartości liczbowe są większe od 0?
-   czy mental health score i addicted score przyjmują wartości 1 - 10?
-   płeć - kobieta lub mężczyzna?
-   poziom wykształcenia - szkoła średnia, studia I stopnia lub studia II stopnia
-   status związku - wolny, w związku, "to skomplikowane"
-   czy wpływa na wyniki akademickie - tak lub nie?

```{r}
reguly <- validator(
Age >= 16 & Age <= 25,
Gender %in% c("Female", "Male"),
Academic_Level  %in% c("High School", "Undergraduate", "Graduate"),
Avg_Daily_Usage_Hours > 0 & Avg_Daily_Usage_Hours < 24,
Affects_Academic_Performance %in% c("Yes", "No"),
Sleep_Hours_Per_Night >= 0 & Sleep_Hours_Per_Night <= 24,
Mental_Health_Score >= 1 & Mental_Health_Score<=10,
Relationship_Status %in% c("In Relationship", "Single", "Complicated"),
Addicted_Score >= 1 & Addicted_Score <= 10
)
```

```{r}
cf <- confront(dane, reguly, key="Student_ID")

barplot(cf)

```

# Wizualizacja danych

## Charakterystyka demograficzna badanej grupy studenckiej

### Rozkład Płci i Poziomu Akademickiego

```{r}
dane$Academic_Level <- factor(dane$Academic_Level, 
                            levels = c("High School", "Undergraduate", "Graduate"))
dane$Gender <- factor(dane$Gender,
                  levels = c("Male", "Female")
)

ggplot(dane, aes(x = Academic_Level, fill=Gender)) +
  geom_bar(position = "dodge") +
  labs(title = "Rozkład płci i poziomu akademickiego",
       x = "Poziom akademicki",
       y = "Liczba studentów") +
  theme_minimal()
```

Analiza struktury demograficznej wskazuje na równomierny rozkład płci (blisko 50/50), natomiast w podziale na poziom edukacji przeważają osoby na studiach I i II stopnia, stanowiąc łącznie ponad 96% próby.

### Wiek badanych

```{r}
ggplot(dane, aes(x = Age)) +
  geom_histogram(binwidth = 0.5, fill = "skyblue", color = "black") +
  labs(title = "Wiek badanych studentów",
       x = "Wiek",
       y = "Liczba studentów") +
  theme_minimal()
```

Większość badanych to osoby w wieku od 19 do 23 lat, co wskazuje na silną koncentrację danych wokół typowego wieku studenckiego. Średnia wieku w próbie wynosi około 21 lat.

## Intensywność Używania Social Mediów

### Średni czas użycia

```{r}
ggplot(dane, aes(x = Avg_Daily_Usage_Hours)) +
  geom_histogram(binwidth = 1, fill = "#9f2042", color = "#6c0d27") +
  labs(title = "Średni czas użycia social mediów dziennie",
       x = "Średni czas użycia (h)",
       y = "Liczba studentów") +
  theme_minimal()
```

Większość studentów spędza w mediach społecznościowych od 4 do 6 godzin dziennie, przy czym średnia dla całej grupy wynosi blisko 5 godzin. Rozkład wskazuje, że znaczna część badanych deklaruje wysoką aktywność cyfrową, przekraczającą 4 godziny na dobę.

### Najczęściej używane platformy

```{r}
dane %>%
mutate(top_5 = fct_lump_n(Most_Used_Platform, n = 4, other_level = "Inne")) %>%
  ggplot(aes(x = top_5)) +
  geom_bar(fill = "#6c0d27") +
  labs(title = "Najczęściej używane platformy social media",
       x = "Platforma",
       y = "Liczba studentów") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

## Wpływ social mediów na wyniki akademickie

```{r}

wykres <- dane %>%
  count(Addicted_Score) %>%
  ggplot(aes( x = Addicted_Score, y=n)) +
  geom_point(color= "blue")+
  geom_line(color= "blue")+
  labs(title = "Poziom uzależnienia uczniów",
       x = "Poziom uzależnienia",
       y = "Liczba uczniów") +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5)
  )
plotly:: ggplotly(wykres)
```

Największa liczba badanych koncentruje się na umiarkowanych i wyższych poziomach uzależnienia, co wskazuje na powszechność intensywnego korzystania z mediów społecznościowych w badanej grupie.

```{r}
ggplot(dane, aes(x = Affects_Academic_Performance)) +
  geom_bar(fill = "#6c0d27", width= 0.5)+
  scale_x_discrete(
    labels = c(
      "Yes" = "Tak",
      "No"  = "Nie"
    )
  ) +
  labs(title = "Wpływ social mediów na wyniki akademickie",
       x = "Czy social media wpływają na wyniki akademickie?", 
       y = "Liczba studentów")+
         theme_minimal()+
   theme(
    plot.title = element_text(hjust = 0.5)
  )

```

Zdecydowana większość badanych zadeklarowała, że korzystanie z social mediów wpływa na ich osiągnięcia akademickie, podczas gdy mniejsza część respondentów nie dostrzega takiego wpływu. Uzyskane wyniki sugerują, że studenci w dużym stopniu są świadomi oddziaływania mediów społecznościowych na wyniki w nauce.

## Social media a zdrowie psychiczne

```{r}
ggplot(dane, aes(x= Avg_Daily_Usage_Hours, y = Mental_Health_Score))+
geom_smooth(method = "lm", se = F) +
 labs(
    title = "Zależność między uzależnieniem od social mediów a zdrowiem psychicznym",
    x = "Poziom uzależnienia",
    y = "Poziom zdrowia psychicznego"
  ) +
  theme_minimal()+
  theme(
    plot.title = element_text(hjust = 0.5)
  )
```

Wykres przedstawia linię regresji liniowej obrazującą zależność pomiędzy poziomem uzależnienia od social mediów a zdrowiem psychicznym studentów. Wraz ze wzrostem poziomu uzależnienia obserwuje się spadek wyników zdrowia psychicznego.

## Wpływ social mediów na relacje interpersonalne

```{r}
ggplot(dane, aes(x = Avg_Daily_Usage_Hours, y = Conflicts_Over_Social_Media)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", col = "blue") +
  labs(title = "Korelacja czasu używania social mediów z liczbą konfliktów") +
  theme_light()
```

Wykres przedstawia zależność pomiędzy przeciętną liczbą godzin używania social mediów a liczbą konfliktów spowodanych social mediami wraz z przeiwdywaną linią trendu. Przy wzroście średniego dziennego użytkowania social mediów zauważa się również wzrost liczby konfliktów w tym temacie.

# Statystyki opisowe

## Statystyki opisowe dla zmiennej Avg_Daily_Usage_Hours w podziale na 5 najczęściej używanych platform

Ze względu na nierówną liczebność obserwacji w poszczególnych kategoriach zmiennej Most Used Platform, analizę ograniczono do pięciu najczęściej deklarowanych platform społecznościowych.

```{r}
top5_platform <- dane %>%
  count(Most_Used_Platform, sort = TRUE) %>%
  slice_head(n = 5) %>%
  pull(Most_Used_Platform)

Avg_Daily_Usage_Hours <- dane %>%
  filter(Most_Used_Platform %in% top5_platform) %>%
  group_by(Most_Used_Platform) %>%
  summarise(
    N = n(),
    Min = min(Avg_Daily_Usage_Hours),
    Q1 = quantile(Avg_Daily_Usage_Hours, 0.25),
    Mediana = median(Avg_Daily_Usage_Hours),
    Średnia = mean(Avg_Daily_Usage_Hours),
    Q3 = quantile(Avg_Daily_Usage_Hours, 0.75),
    Max = max(Avg_Daily_Usage_Hours),
    SD = sd(Avg_Daily_Usage_Hours),
    IQR = IQR(Avg_Daily_Usage_Hours)
  )
    
kable(
  Avg_Daily_Usage_Hours,
  digits = 2,
  caption = "Statystyki opisowe Avg_Daily_Usage_Hours dla 5 najczęściej używanych platform"
) %>%
  kable_paper(full_width = FALSE)
```

Osoby, które wskazały WhatsApp jako najczęściej używaną aplikację, spędzają przeciętnie najwięcej czasu ogółem w mediach społecznościowych w ciągu dnia. Wysoki łączny czas korzystania obserwuje się również wśród użytkowników TikToka, natomiast osoby deklarujące Facebook, Instagram lub Twitter jako najczęściej używaną platformę spędzają w mediach społecznościowych średnio mniej czasu. Największe zróżnicowanie dziennego czasu korzystania występuje wśród użytkowników Instagrama, a najmniejsze w grupie użytkowników WhatsAppa. 

```{r kable_report, echo=FALSE}
top5_platform <- dane %>%
  count(Most_Used_Platform, sort = TRUE) %>%
  slice_head(n = 5) %>%
  pull(Most_Used_Platform)

dane_top5 <- dane %>% filter(Most_Used_Platform %in% top5_platform)
mostusedplatform_addictedscore <- split(dane_top5$Addicted_Score, dane_top5$Most_Used_Platform)

inline_plot <- data.frame( 
  platform = names(mostusedplatform_addictedscore),
  boxplot = "",
  histogram = "",
  points1 = ""
)

inline_plot %>%
  kbl(booktabs = TRUE, caption = "Tabela 4.2. Tabela rozkładu poziomu uzależnienia w podziale na TOP 5 najczęściej używanych platform") %>%
  kable_paper(full_width = FALSE) %>%
  column_spec(2, image = spec_boxplot(mostusedplatform_addictedscore)) %>%
  column_spec(3, image = spec_hist(mostusedplatform_addictedscore)) %>%
  column_spec(4, image = spec_plot(mostusedplatform_addictedscore, type = "p",))
```

## Statystyki opisowe dla zmiennej Addicted Score w podziale na płeć
```{r}
raport <- list("Addicted Score" = 
                 list("Min"= ~ min(Addicted_Score), 
                      "Max"= ~ max(Addicted_Score), 
                      "Q1"= ~ quantile(Addicted_Score,0.25), 
                      "Mediana"= ~ round(median(Addicted_Score),2), 
                      "Q3"= ~ quantile(Addicted_Score,0.75), 
                      "Średnia"= ~ round(mean(Addicted_Score),2), 
                      "Odch. std."= ~ round(sd(Addicted_Score),2), 
                      "IQR"= ~ round(IQR(Addicted_Score),2), 
                      "Odch. ćwiartkowe"=~round(IQR(Addicted_Score)/2,2), 
                      "Odch. std. w %"=~round((sd(Addicted_Score)/mean(Addicted_Score)),2), "Odch. ćwiartkowe w %"=~round((IQR(Addicted_Score)/median(Addicted_Score)),2), "Skośność"=~round(skew(Addicted_Score),2), "Kurtoza"=~round(kurtosi(Addicted_Score),2) ))
tabela_gender <- dane %>%
  group_by(Gender) %>%
  summarise(
    Min = min(Addicted_Score),
    Q1 = quantile(Addicted_Score, 0.25),
    Mediana = median(Addicted_Score),
    Q3 = quantile(Addicted_Score, 0.75),
    Max = max(Addicted_Score),
    Średnia = mean(Addicted_Score),
    SD = sd(Addicted_Score),
    Skośność = psych::skew(Addicted_Score),
    Kurtoza = psych::kurtosi(Addicted_Score)
  )

kable(tabela_gender,
      digits = 2,
      caption = "Tabela 4.3. Statystyki opisowe Addicted_Score w podziale na płeć") %>%
  kable_paper("striped", full_width = FALSE)
```

Średnie i mediany wyników uzależnienia są podobne dla obu płci, przy czym kobiety mają nieco wyższą średnią i większą zmienność. Różnice między mężczyznami a kobietami są niewielkie i nie wskazują na znaczącą przewagę jednej grupy pod względem poziomu uzależnienia.

## Macierz korelacji między poziomem uzależnienienia od social mediów, zdrowiem psychicznym, wiekiem i średnią liczbą używania social mediów
```{r bivariate, echo=FALSE, warning=TRUE}
num_cols <- dane[, c("Addicted_Score", "Mental_Health_Score", "Avg_Daily_Usage_Hours", "Age")]
corr_matrix <- cor(num_cols, use="complete.obs")
corrplot(corr_matrix, 
         method = "color", 
         type = "upper", 
         addCoef.col = "black", 
         tl.col = "black")
```
Zachodzi pełną zależność ujemną między poziomem uzależnieniem a zdrowiem psychicznym (-0.95), co oznacza, że wzrostowi uzależnienia, zawsze towarzyszy spadek zdrowia psychicznego. Kluczowym czynnikiem wpływającym na oba te parametry jest średni dzienny czas korzystania z mediów społecznościowych, który silnie koreluje z poziomem uzależnienia (0.83) oraz obniżeniem zdrowia psychicznej (-0.80). Jednocześnie wiek badanych nie ma istotnego znaczenia dla tych relacji, wykazując jedynie śladowe i nieznaczące statystycznie powiązania z resztą zmiennych.

# Wnioskowanie statystyczne

```{r}
ggbetweenstats(dane, Gender, Addicted_Score)
```

```{r}
ggbetweenstats(dane, Academic_Level , Addicted_Score)

```

```{r}
anova <- aov(Mental_Health_Score ~ Most_Used_Platform, data=dane)

dane |>
aov(Mental_Health_Score ~ Most_Used_Platform, data=_) |>
tidy() |>
kbl() |>
kable_classic(full_width = FALSE, html_font="Cambria")
```

## Czy istnieje zależność między poziomem edukacji a najczęściej używaną aplikacją?

```{r}
ggpiestats(dane, Academic_Level, Most_Used_Platform, bf.message = FALSE)
```
